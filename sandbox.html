<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Sandbox | AI Ethics Academy</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="common.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="common.js" defer></script>
  <style>
    .toggle {
      border:1px solid #ccc;
      padding:0.4rem 1rem;
      border-radius:6px;
      cursor:pointer;
      margin:0 0.5rem;
      font-weight:600;
    }
    .toggle.active {
      background:var(--teal);
      color:white;
      border-color:var(--teal-dark);
    }
    input[type="range"] {
      width:200px;
      margin:0 0.5rem;
    }
    textarea {
      width:100%;
      height:120px;
      border:1px solid #ccc;
      border-radius:6px;
      padding:0.5rem;
      font-family:'Inter',sans-serif;
      font-size:1rem;
      resize:vertical;
    }
    canvas {margin-top:1rem;}
    body.dark .toggle {border-color:#555;}
    body.dark textarea {background:#1e1e1e;color:var(--text-dark);border-color:#555;}
  </style>
</head>
<body>

<header>
  <div class="brand">
    <img class="logo" src="https://online.uc.edu/wp-content/uploads/2024/08/What-Is-AI-Featured.jpg" alt="AI Ethics Academy Logo">
    <h1>AI Ethics Academy</h1>
  </div>
  <nav>
    <ul>
      <li><a href="index.html">Home</a></li>
      <li><a href="learn.html">Learn</a></li>
      <li><a href="quiz.html">Quiz</a></li>
      <li><a href="sandbox.html" aria-current="page">Sandbox</a></li>
      <li><a href="read.html">Read</a></li>
      <li><a href="teach.html">Teach</a></li>
      <li><a href="chat.html">Chat</a></li>
    </ul>
  </nav>
  <div style="display:flex;gap:.5rem;align-items:center">
    <button id="theme-toggle">Dark Mode</button>
  </div>
</header>

<main>
  <section class="card" style="text-align:center;">
    <h2>AI Ethics Sandbox</h2>
    <p>Use the sliders and controls below to explore how bias affects AI decisions.  
    Adjust variables, train the dataset, and preview how a simulated AI system behaves.</p>
  </section>

  <section class="card">
    <h3>Adjust Applicant Variables</h3>
    <div class="flex"><label>Experience:</label><input type="range" id="exp" min="0" max="100" value="50"><span id="exp-val">50</span></div>
    <div class="flex"><label>Education:</label><input type="range" id="edu" min="0" max="100" value="50"><span id="edu-val">50</span></div>
    <div class="flex"><label>Bias Factor:</label><input type="range" id="bias" min="0" max="100" value="50"><span id="bias-val">50</span></div>
    <p style="margin-top:.5rem;font-size:.9rem;color:gray;">Bias Factor represents how much hidden bias influences outcomes.  
    Low = fairer model; High = stronger bias skewing results.</p>

    <div class="flex" style="flex-wrap:wrap;align-items:center;margin-top:.5rem;">
      <label>Decision:</label>
      <div id="accept" class="toggle active">Accept</div>
      <div id="reject" class="toggle">Reject</div>
      <label>Applicants:</label>
      <input type="number" id="count" value="10" min="1" style="width:80px;">
      <button id="train" class="cta">Train</button>
    </div>
  </section>

  <section class="card">
    <h3>AI Decision Preview</h3>
    <div class="flex" style="flex-wrap:wrap;align-items:center;">
      <label>Experience:</label>
      <input type="number" id="test-exp" value="60" min="0" max="100" style="width:80px;">
      <label>Education:</label>
      <input type="number" id="test-edu" value="70" min="0" max="100" style="width:80px;">
      <button id="predict" class="cta">Predict</button>
      <span id="prediction" style="font-weight:700;margin-left:1rem;"></span>
    </div>
  </section>

  <section class="card">
    <h3>Dataset Summary</h3>
    <canvas id="datasetChart" height="220"></canvas>
  </section>

  <section class="card">
    <h3>Reflection</h3>
    <p>Type your thoughts on fairness, bias, and model training outcomes:</p>
    <textarea placeholder="Type here..."></textarea>
  </section>
</main>

<script>
['exp','edu','bias'].forEach(id=>{
  const el=document.getElementById(id);
  const val=document.getElementById(id+'-val');
  el.oninput=()=>val.textContent=el.value;
});

let decision='accept';
document.getElementById('accept').onclick=()=>{
  decision='accept';
  document.getElementById('accept').classList.add('active');
  document.getElementById('reject').classList.remove('active');
};
document.getElementById('reject').onclick=()=>{
  decision='reject';
  document.getElementById('reject').classList.add('active');
  document.getElementById('accept').classList.remove('active');
};

let dataset={accept:0,reject:0,expSum:0,eduSum:0,biasSum:0,total:0};

const ctx=document.getElementById('datasetChart').getContext('2d');
let chart=new Chart(ctx,{
  type:'bar',
  data:{
    labels:['Accepted','Rejected','Avg Experience','Avg Education','Avg Bias'],
    datasets:[{
      label:'Dataset Stats',
      data:[0,0,0,0,0],
      backgroundColor:['#00bfa6','#ff5f5f','#5ad7c1','#42c7b2','#2eb09f']
    }]
  },
  options:{scales:{y:{beginAtZero:true}},plugins:{legend:{display:false}}}
});

document.getElementById('train').onclick=()=>{
  const n=parseInt(document.getElementById('count').value)||0;
  if(n<=0)return;
  const exp=parseInt(document.getElementById('exp').value);
  const edu=parseInt(document.getElementById('edu').value);
  const bias=parseInt(document.getElementById('bias').value);
  if(decision==='accept')dataset.accept+=n;else dataset.reject+=n;
  dataset.expSum+=exp*n;dataset.eduSum+=edu*n;dataset.biasSum+=bias*n;
  dataset.total+=n;
  const avgExp=dataset.expSum/dataset.total;
  const avgEdu=dataset.eduSum/dataset.total;
  const avgBias=dataset.biasSum/dataset.total;
  chart.data.datasets[0].data=[dataset.accept,dataset.reject,avgExp,avgEdu,avgBias];
  chart.update();
};

document.getElementById('predict').onclick=()=>{
  const exp=parseInt(document.getElementById('test-exp').value);
  const edu=parseInt(document.getElementById('test-edu').value);
  const avgBias=dataset.total>0?(dataset.biasSum/dataset.total):50;
  const score=(exp*0.4+edu*0.4-avgBias*0.2);
  const result=score>50?'AI would ACCEPT this applicant.':'AI would REJECT this applicant.';
  const pred=document.getElementById('prediction');
  pred.textContent=result;
  pred.style.color=score>50?'var(--teal)':'#ff5f5f';
};
</script>
</body>
</html>
